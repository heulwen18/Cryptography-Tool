<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA Encryption/Decryption</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/10.0.19/jsrsasign-all-min.js"></script> <!-- Include jsrsasign for RSA -->
    <script>
        // Function to generate RSA keys
        function generateRSAKeys(keySize = 1024) {
            if (keySize < 512) {
                alert("Key size too small. Must be at least 512 bits.");
                return;
            }

            const rsaKey = new RSAKey();
            rsaKey.generate(keySize, 65537); // 65537 is a common public exponent

            const publicKey = rsaKey.getPublicString();
            const privateKey = rsaKey.getPrivateString();

            return {
                publicKey: publicKey,
                privateKey: privateKey
            };
        }

        // Function to encrypt plain text using RSA public key
        function rsaEncrypt(plainText, publicKey) {
            if (!plainText || typeof plainText !== "string") {
                alert("Invalid plain text input. Must be a non-empty string.");
                return;
            }

            const rsaKey = new RSAKey();
            rsaKey.setPublic(publicKey, "10001"); // Set the public key (65537 is a common public exponent)
            const cipherText = rsaKey.encrypt(plainText);
            return cipherText;
        }

        // Function to decrypt cipher text using RSA private key
        function rsaDecrypt(cipherText, privateKey) {
            if (!cipherText || typeof cipherText !== "string") {
                alert("Invalid cipher text input. Must be a non-empty string.");
                return;
            }

            const rsaKey = new RSAKey();
            rsaKey.setPrivate(privateKey);
            const decryptedText = rsaKey.decrypt(cipherText);
            return decryptedText;
        }

        // Handle encryption when the user clicks the "Encrypt" button
        function encrypt() {
            const plainText = document.getElementById("plainText").value.trim();

            if (!plainText) {
                alert("Please enter plain text to encrypt.");
                return;
            }

            // Generate RSA keys
            const { publicKey, privateKey } = generateRSAKeys();
            document.getElementById("privateKey").value = privateKey;

            // Encrypt the text using RSA public key
            const cipherText = rsaEncrypt(plainText, publicKey);
            document.getElementById("cipherText").value = cipherText;
        }

        // Handle decryption when the user clicks the "Decrypt" button
        function decrypt() {
            const cipherText = document.getElementById("cipherText").value.trim();
            const privateKey = document.getElementById("privateKey").value.trim();

            if (!cipherText || !privateKey) {
                alert("Please enter both cipher text and private key to decrypt.");
                return;
            }

            // Decrypt the cipher text using RSA private key
            const plainText = rsaDecrypt(cipherText, privateKey);
            document.getElementById("plainText").value = plainText;
        }
    </script>
</head>
<body>
    <h1>RSA Encryption/Decryption</h1>

    <div>
        <h2>Encrypt</h2>
        <textarea id="plainText" placeholder="Enter plain text"></textarea>
        <button onclick="encrypt()">Encrypt</button>
        <h3>Encrypted Text</h3>
        <textarea id="cipherText" placeholder="Cipher text" readonly></textarea>
    </div>

    <div>
        <h2>Decrypt</h2>
        <textarea id="cipherText" placeholder="Enter cipher text"></textarea>
        <input id="privateKey" type="text" placeholder="Enter RSA private key" />
        <button onclick="decrypt()">Decrypt</button>
        <h3>Decrypted Text</h3>
        <textarea id="plainText" placeholder="Decrypted plain text" readonly></textarea>
    </div>

    <a href="main.html" class="back-link">Back to Home</a>
</body>
</html>
